document.addEventListener("DOMContentLoaded",(function(){let t=!1;const e=(e,a)=>{const n=e.closest(".wp-block-vayu-blocks-advance-query-loop"),o=e.querySelector("a"),r=parseInt(e.getAttribute("data-page")),d=parseInt(e.getAttribute("data-max-page")),i=parseInt(e.getAttribute("data-per-page")),l=window.location.pathname.split("/")[1];if(r>d)return;t=!0,o.textContent=e.getAttribute("data-loadmore-label"),e.setAttribute("disabled","disabled");const s=JSON.parse(n.getAttribute("data-attrs")),c=`${window.location.origin}/${l}/wp-admin/admin-ajax.php`,u=new FormData;u.append("action","load_more_posts"),u.append("page",r),u.append("perpage",i),u.append("query_id",e.getAttribute("data-query-id")),u.append("attrs",JSON.stringify(s)),fetch(c,{method:"POST",body:u}).then((t=>t.json())).then((t=>{if(t.success){const a=t.data.content,n=document.querySelector(".wp-block-vayu-blocks-wrapper");n&&n.insertAdjacentHTML("beforeend",a),e.setAttribute("data-page",r+1),e.setAttribute("data-current-page",r),r+1>d?(o.textContent=e.getAttribute("data-nomorepost-label"),e.setAttribute("disabled","disabled")):(o.textContent=e.getAttribute("data-loadmorebtn-txt"),e.removeAttribute("disabled"))}else console.error("Error fetching posts:",t),o.textContent=e.getAttribute("data-loadmorebtn-txt"),e.removeAttribute("disabled")})).catch((t=>{console.error("Error:",t),o.textContent=e.getAttribute("data-loadmorebtn-txt"),e.removeAttribute("disabled")})).finally((()=>{t=!1}))};(()=>{const t=document.querySelector(".load-more-btn");t&&t.addEventListener("click",(function(a){"loadmorebtn"===t.getAttribute("data-loadmore-type")&&(a.preventDefault(),e(t))}))})(),window.addEventListener("scroll",(function(){const a=document.querySelector(".load-more-btn");if(!a||t)return;const n=a.getBoundingClientRect(),o=window.innerHeight||document.documentElement.clientHeight;if(n.top-o<100){"loadinfinite"===a.getAttribute("data-loadmore-type")&&e(a)}}))}));